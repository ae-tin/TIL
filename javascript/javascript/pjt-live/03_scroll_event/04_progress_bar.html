<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
      * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    .progress-bar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 15px;
        background: lightgrey;
        /* z-index: 1000; */
    }

    .progress-fill {
        height: 100%;
        width: 100%;
        background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1); /* 단색 대신 그라데이션 형태로 */
        transform-origin: left; /* 왼쪽을 고정하고 변화는 우측 위주로 진행 */
        transform: scaleX(0);  /* 초기 설정 */
        transition: transform 0.1s ease;  /* 부드러운 변환을 위함 */
    }

    .section {
      height: 100vh;
      border: 1px lightblue dashed;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  </style>
</head>
<body>
  <div class="progress-bar">
    <div class="progress-fill"></div>
  </div>

  <div class="section">
    <p>스크롤은 넘길 화면이 없으면 동작하지 않습니다.</p>
  </div>

  <div class="section">
    <p>스크롤이 생길 수 있도록 내용을 채워두겠습니다.</p>
  </div>

  <div class="section">
    <p>상단에 프로그래스 바가 잘 동작하는지 확인하세요.</p>
  </div>

  <script>
    const progressFill = document.querySelector('.progress-fill')

    function updateProgress (e) {
      // 현재 스크롤의 위치
      const scrollY = window.scrollY

      // 진행률 계산
      // 현재 높이 / 전체 높이 인 것 같지만
      // 스크롤은 현재 보여지는 높이는 제외해야 함 (스크롤 한다는 것은 보이지 않는(즉, 뷰포트를 제외한) 영역을 보겠다는 의미)
      // 스크롤 한다는 것은 화면에 보이지 않는 영역의 높이 만큼 내려가야 한다는 의미

      // 스크롤할 수 있는 최대 거리 (화면에 보이는 영역을 제외하고 추가로 스크롤 할 수 있는 거리)
      // = 전체 요소의 높이 - 뷰포트(보이는 영역) 의 높이
      const scrollHeight = document.documentElement.scrollHeight - window.innerHeight
      // 진행률은 스크롤 가능한 거리를 현재 위치로 나누면 됨
      const progress = scrollY / scrollHeight

      progressFill.style.transform = `scaleX(${progress})`
    }

    // 스크롤 이벤트는 윈도우에서 발생하는 이벤트
    window.addEventListener('scroll', updateProgress)

  </script>
</body>
</html>